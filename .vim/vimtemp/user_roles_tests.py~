from testing import unit, integration
import deepy.make
from deepy.timerange import arrow_factory
import os
import sys
import time
import deepy.user_roles
import unittest

class UserRolesTest(unittest.TestCase):
    email_a = 'a@b.com'
    role_a = {
        'name': 'role_a',
    }
    role_b = {
        'name': 'role_b',
    }

    @unit
    def test_get_roles_for_user_nones(self):
        ret = deepy.user_roles.get_roles_for_user(None, {}, [])
        self.assertEqual(ret, [])

    @unit
    def test_get_roles_for_user_no_roles(self):
        users_config = {
            'users': [
                {
                    'email': self.email_a,
                },
            ],
        }

        ret = deepy.user_roles.get_roles_for_user(self.email_a, users_config, [])
        self.assertEqual(ret, [])

    @unit
    def test_get_roles_for_user_has_roles(self):
        users_config = {
            'users': [
                {
                    'email': self.email_a,
                    'roles': [self.role_a['name'], self.role_b['name']]
                },
            ],
        }

        user_roles = [
            self.role_a,
            self.role_b,
        ]

        ret = deepy.user_roles.get_roles_for_user(self.email_a, users_config, user_roles)
        self.assertEqual(ret, [self.role_a, self.role_b])


